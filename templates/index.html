{% extends "base.html" %}

{% block content %}
    <div class="info">
        <p><strong>Total Wishes:</strong> {{ total_wishes }}</p>
    </div>

    <!-- Form to add a new wish -->
    <h2>Add a New Wish</h2>
    <form method="POST" action="{{ url_for('add_wish') }}">
        <label for="person_name">Person Name (required):</label>
        <input type="text" id="person_name" name="person_name" required>
        
        <label for="wish_text">Wish Text (required):</label>
        <textarea id="wish_text" name="wish_text" rows="3" required></textarea>
        
        <label for="product_link">Product Link (optional):</label>
        <input type="text" id="product_link" name="product_link" placeholder="https://...">
        
        <button type="submit" class="btn-primary">Add Wish</button>
    </form>

    <!-- Table displaying all wishes -->
    <h2>All Wishes</h2>
    {% if wishes %}
    <table>
        <thead>
            <tr>
                <th>Person Name</th>
                <th>Wish Text</th>
                <th>Product Link</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for wish in wishes %}
            <tr class="{% if wish.reserved %}reserved{% endif %}">
                <td>{{ wish.person_name }}</td>
                <td>{{ wish.wish_text }}</td>
                <td>
                    {% if wish.product_link %}
                        <a href="{{ wish.product_link }}" target="_blank">View Product</a>
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>
                    {% if wish.reserved %}
                        <strong style="color: #c41e3a;">‚úì Reserved</strong>
                    {% else %}
                        Available
                    {% endif %}
                </td>
                <td>
                    <!-- Reserve/Unreserve button -->
                    <form method="POST" action="{{ url_for('reserve_wish', wish_id=wish.id) }}" style="display: inline;">
                        {% if wish.reserved %}
                            <button type="submit" class="btn-unreserve">Unreserve</button>
                        {% else %}
                            <button type="submit" class="btn-reserve">Reserve</button>
                        {% endif %}
                    </form>
                    
                    <!-- Delete button -->
                    <form method="POST" action="{{ url_for('delete_wish', wish_id=wish.id) }}" style="display: inline;">
                        <button type="submit" class="btn-delete" onclick="return confirm('Are you sure you want to delete this wish?');">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="text-align: center; color: #666; margin: 40px 0;">
        No wishes yet. Add the first one above! üéÅ
    </p>
    {% endif %}
{% endblock %}
